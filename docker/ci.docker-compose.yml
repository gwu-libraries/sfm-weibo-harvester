sfmrabbit:
    image: rabbitmq:3-management
    environment:
        - RABBITMQ_DEFAULT_USER=sfm_user
        - RABBITMQ_DEFAULT_PASS=password
sfmweiboharvester:
    image: gwul/sfm-weibo-harvester:dev
    links:
        - sfmrabbit:mq
    volumes:
        - "..:/opt/sfm-weibo-harvester"
    environment:
        - WEIBO_API_KEY
        - WEIBO_API_SECRET
        - WEIBO_REDIRECT_URI
        - WEIBO_ACCESS_TOKEN
    command: bash -c "pip install -r requirements.txt --upgrade && appdeps.py --port-wait mq:5672 && python weibo_harvester.py --debug=True service mq sfm_user password "
